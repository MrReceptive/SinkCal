<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>Satisfactory AWESOME Sink Coupon Optimizer</title>
  <meta name="viewport" content="width=device-width,initial-scale=1">
  <style>
    body { font-family: system-ui, sans-serif; background: #23272e; color: #f6f6f7; padding: 24px; }
    input, button { font-size: 1em; margin: 3px 0 10px 0; padding: 3px 8px; }
    .result { background: #181a1b; border-radius: 10px; padding: 12px; margin-top: 10px; }
    table { border-collapse: collapse; width: 100%; }
    th, td { border-bottom: 1px solid #333; padding: 6px 10px; }
    th { background: #32363e; }
    tr:nth-child(even) { background: #262a30; }
    .small { font-size: 0.95em; opacity: 0.7; }
  </style>
</head>
<body>
  <h2>AWESOME Sink Coupon Optimizer</h2>
  <div>
    <label>How many coupons do you want? <input id="numCoupons" type="number" value="1" min="1" max="100"></label><br>
    <label>Current points (or points to next coupon): <input id="points" type="number" value="0" min="0"></label>
    <button onclick="calc()">Find Best Items</button>
    <span class="small" id="fetchStatus"></span>
  </div>
  <div id="invWrap"></div>
  <div class="result" id="output"></div>
  <script>
    // Static point table based on latest wiki data (July 2024)
    const itemPoints = {
      "Iron Ingot": 2, "Copper Ingot": 3, "Caterium Ingot": 12, "Steel Ingot": 8, "Aluminum Ingot": 11,
      "Pure Iron Ingot": 2, "Pure Copper Ingot": 3, "Pure Caterium Ingot": 12, "Pure Aluminum Ingot": 11,
      "Iron Plate": 6, "Reinforced Iron Plate": 240, "Stitched Iron Plate": 160, "Iron Rod": 4, "Screw": 1, "Steel Pipe": 24,
      "Steel Beam": 60, "Encased Industrial Beam": 480, "Copper Sheet": 12, "Wire": 2, "Cable": 9, "Quickwire": 11,
      "Fused Quickwire": 60, "Alclad Aluminum Sheet": 60, "Concrete": 12, "Silica": 24, "Quartz Crystal": 37,
      "Crystal Oscillator": 2200, "AI Limiter": 1190, "High-Speed Connector": 1960, "Circuit Board": 924,
      "Compacted Coal": 42, "Sulfur": 12, "Black Powder": 24, "Smokeless Powder": 360, "Steel Canister": 30,
      "Empty Canister": 6, "Aluminum Casing": 30, "Empty Fluid Tank": 30, "Rubber": 24, "Plastic": 24, "Polymer Resin": 12,
      "Fabric": 140, "Biomass": 12, "Mycelia": 100, "Wood": 90, "Leaves": 12, "Alien Protein": 100, "Alien DNA Capsule": 500,
      "Flower Petals": 24, "Color Cartridge": 6, "Packaged Water": 12, "Packaged Oil": 60, "Packaged Fuel": 300,
      "Packaged Liquid Biofuel": 270, "Packaged Heavy Oil Residue": 90, "Packaged Turbofuel": 900,
      "Packaged Alumina Solution": 18, "Packaged Sulfuric Acid": 18, "Packaged Nitric Acid": 72,
      "Packaged Nitrogen Gas": 6, "Packaged Oxygen": 18, "Packaged Iron Ore": 2, "Packaged Copper Ore": 3,
      "Packaged Caterium Ore": 12, "Packaged Bauxite": 11, "Packaged Coal": 5, "Packaged Raw Quartz": 12,
      "Packaged Sulfur": 12, "Packaged Limestone": 3, "Packaged S.A.M. Ore": 5, "Packaged Uranium Ore": 150,
      "Packaged Uranium Waste": 3000, "Modular Frame": 300, "Heavy Modular Frame": 3080,
      "Fused Modular Frame": 15000, "Versatile Framework": 1500, "Automated Wiring": 990,
      "Smart Plating": 600, "Blue Power Slug": 1500, "Yellow Power Slug": 5000, "Purple Power Slug": 15000,
      "Rotor": 140, "Stator": 260, "Motor": 1840, "Turbo Motor": 3960, "Computer": 3420, "Supercomputer": 16200,
      "Battery": 210, "Uranium Fuel Rod": 120000, "Plutonium Fuel Rod": 580000, "Nuclear Pasta": 1710000,
      "Radio Control Unit": 5480, "Heat Sink": 840, "Cooling System": 4320, "Pressure Conversion Cube": 15000,
      "Oscillating Crystal": 2200, "Beacon": 672, "Packaged Nitrogen Gas": 6, "Packaged Oxygen": 18,
      "Packaged Water": 12, "Copper Powder": 60, "Iron Rebar": 8, "Spiked Rebar": 50, "Stun Rebar": 160,
      "Shatter Rebar": 160, "Explosive Rebar": 540, "Cluster Nobelisk": 1875, "Gas Nobelisk": 1875,
      "Pulse Nobelisk": 1875, "Nuke Nobelisk": 7500, "Nobelisk": 525, "Snowball": 24, "FICSMAS Decoration": 48,
      "FICSMAS Ornament": 120, "FICSMAS Bow": 180, "FICSMAS Tree Branch": 24, "FICSMAS Star": 1200,
      "Candy Cane": 240, "Gingerbread Cookie": 72, "Actual Snow": 18, "Gift": 48, "Red Firework": 750,
      "Blue Firework": 750, "Gold Firework": 1500, "Iron Ore": 2, "Copper Ore": 3, "Caterium Ore": 12, "Bauxite": 11,
      "Coal": 5, "Raw Quartz": 12, "Limestone": 3, "S.A.M. Ore": 5, "Uranium Ore": 150, "Uranium Waste": 3000
    };
    let sortedItems = Object.entries(itemPoints).sort((a, b) => b[1] - a[1]);
    const couponFormula = n => Math.pow(2, n) * 1000;

    function buildInventoryInputs() {
      let html = `<details><summary>Show/Enter Inventory (optional)</summary>
        <div style="max-height:200px;overflow:auto"><table>`;
      for (let [item, pts] of sortedItems.slice(0, 50)) {
        html += `<tr>
          <td>${item}</td>
          <td><input type="number" min="0" id="inv_${item.replace(/[^a-zA-Z0-9]/g,'_')}" style="width:70px"></td>
          <td class="small">(${pts} pts each)</td>
        </tr>`;
      }
      html += `</table><span class="small">Leave blank for items you don’t own</span></div></details>`;
      document.getElementById("invWrap").innerHTML = html;
    }
    buildInventoryInputs();

    function calc() {
      let wantCoupons = parseInt(document.getElementById("numCoupons").value) || 1;
      let currentPts = parseInt(document.getElementById("points").value) || 0;
      let ptsNeeded = 0, coupons = 0, n = 0;
      while (coupons < wantCoupons) {
        let pts = couponFormula(n);
        if (currentPts < pts) {
          ptsNeeded += pts - currentPts;
          ++coupons;
          currentPts = 0;
        } else {
          currentPts -= pts;
          ++coupons;
        }
        ++n;
      }
      let inv = {};
      for (let [item] of sortedItems) {
        let val = document.getElementById("inv_" + item.replace(/[^a-zA-Z0-9]/g,'_'));
        if (val && val.value) inv[item] = parseInt(val.value) || 0;
      }
      let rec = sortedItems.map(([item, pts])=>{
        let needed = Math.ceil(ptsNeeded/pts);
        let have = inv[item] || 0;
        let canMake = have > 0 ? Math.min(needed, have) : needed;
        return {item, pts, needed, have, canMake};
      }).sort((a,b)=>(a.needed-b.needed) || (b.pts-a.pts));
      let out = `<b>To get ${wantCoupons} coupon${wantCoupons>1?'s':''}, you need ≈${ptsNeeded.toLocaleString()} points:</b><ol>`;
      for (let r of rec.slice(0,10)) {
        out += `<li><b>${r.item}</b>: need <b>${r.needed}</b> (${r.pts} pts each)`;
        if (r.have) out += ` | you have: ${r.have}`;
        out += `</li>`;
      }
      out += `</ol><div class="small">All items and values are included and will work offline!</div>`;
      document.getElementById("output").innerHTML = out;
    }
  </script>
</body>
</html>
